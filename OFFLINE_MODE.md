# Оффлайн режим генерации описаний

Система теперь работает **полностью оффлайн** без необходимости в OpenAI API ключе!

## Как это работает

### 1. Приоритеты генерации описаний:

1. **Словарь заготовленных описаний** (50+ популярных произведений)
   - Если произведение найдено в словаре → возвращается готовое описание
   - Примеры: "Лошадиная фамилия", "Война и мир", "Преступление и наказание"

2. **Оффлайн генерация через эвристики** (если нет в словаре и нет API ключа)
   - Определяет автора по названию (Чехов, Толстой, Достоевский и др.)
   - Определяет тип произведения (рассказ, повесть, роман, поэма)
   - Определяет темы (любовь, война, детектив, комедия и др.)
   - Генерирует описание на основе шаблонов

3. **Wikipedia API** (если есть интернет, но нет API ключа)
   - Пытается найти информацию о произведении в Wikipedia

4. **OpenAI API** (если есть API ключ)
   - Используется как fallback для более качественных описаний

## Примеры работы

### Словарь (известное произведение):
```
Вход: "Лошадиная фамилия. А.П.Чехов"
Выход: "У генерала страшно разболелся зуб, и все вспомнили про чудо-знахаря..."
```

### Оффлайн генерация (неизвестное произведение Чехова):
```
Вход: "Неизвестный рассказ А.П.Чехова о любви"
Выход: "Классический рассказ Чехова о человеческих характерах и жизненных ситуациях. 
        Что скрывается за простым сюжетом? О любви и чувствах история."
```

### Оффлайн генерация (произведение с темой):
```
Вход: "Рассказ о войне и солдатах"
Выход: "Небольшое произведение с глубоким смыслом. О чем заставляет задуматься эта история? 
        О войне и судьбах история."
```

## Добавление новых описаний

Чтобы добавить описание для нового произведения, отредактируйте файл:
`backend/app/services/ai_service.py`

Найдите словарь `known_summaries` и добавьте новую запись:

```python
"название произведения": "Описание в стиле киноанонсов с вопросами для интриги...",
```

## Преимущества оффлайн режима

✅ Работает без интернета  
✅ Работает без API ключей  
✅ Быстро (нет задержек на API запросы)  
✅ Бесплатно  
✅ Приватно (данные не отправляются в облако)  

## Когда использовать OpenAI API

OpenAI API полезен для:
- Генерации описаний для очень редких произведений
- Более качественных и детальных описаний
- Обсуждения цитат (AI чат)

Но для большинства классических произведений оффлайн режим работает отлично!
